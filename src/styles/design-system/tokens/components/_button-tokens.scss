/**
 * Button Component Tokens
 * 
 * Core token values for button styling with gradient support.
 * IMPORTANT: Direct imports to avoid circular dependencies.
 */

// Direct imports of core tokens instead of through tokens/index
@import '../core/colors';
@import '../core/spacing';
@import '../core/typography';

// ----------------------------------------------------------------------------
// BUTTON BASE TOKENS
// ----------------------------------------------------------------------------
$button-base-tokens: (
  'border-radius': var(--radius-md),
  'font-weight': 500,
  'transition': 'all 0.2s ease-in-out',
  'icon-spacing': 0.5rem,
  'disabled-opacity': 0.65,
  'focus-ring-width': 3px
);

// ----------------------------------------------------------------------------
// BUTTON SIZE TOKENS
// ----------------------------------------------------------------------------
$button-size-tokens: (
  'sm': (
    'padding': '0.375rem 0.75rem',
    'font-size': var(--text-sm),
    'padding-x': var(--space-3),
    'padding-y': var(--space-1-5)
  ),
  'md': (
    'padding': '0.625rem 1rem',
    'font-size': var(--text-md),
    'padding-x': var(--space-4),
    'padding-y': var(--space-2-5)
  ),
  'lg': (
    'padding': '0.75rem 1.5rem',
    'font-size': var(--text-lg),
    'padding-x': var(--space-6),
    'padding-y': var(--space-3)
  )
);

// ----------------------------------------------------------------------------
// BUTTON VARIANT TOKENS
// ----------------------------------------------------------------------------
// Button tokens with gradient support
$button-variant-tokens: (
  'primary': (
    'bg': $color-primary-500,
    'gradient-start': $color-primary-500,
    'gradient-end': $color-primary-600,
    'text': white,
    'border': none,
    'hover': (
      'bg': $color-primary-600,
      'shadow': '0 4px 8px -2px rgba(#{$color-primary-rgb}, 0.2)',
      'transform': 'translateY(-1px)'
    ),
    'focus': (
      'ring': rgba($color-primary-500, 0.25)
    ),
    'active': (
      'transform': 'translateY(0)',
      'shadow': '0 2px 4px -1px rgba(#{$color-primary-rgb}, 0.2)'
    ),
    'spinner': (
      'border-color': rgba(255, 255, 255, 0.3),
      'border-top-color': white
    )
  ),
  'secondary': (
    'bg': var(--color-surface-accent),
    'text': var(--color-text),
    'border': none,
    'hover': (
      'bg': var(--color-border),
      'transform': 'translateY(-1px)'
    ),
    'active': (
      'transform': 'translateY(0)',
      'bg': var(--color-border-dark)
    ),
    'dark': (
      'bg': var(--color-dark-surface-hover),
      'text': var(--color-dark-text),
      'hover': (
        'bg': var(--color-dark-highlight)
      )
    ),
    'spinner': (
      'border-color': rgba(var(--color-text-rgb), 0.3),
      'border-top-color': var(--color-text)
    )
  ),
  'outline': (
    'bg': transparent,
    'text': var(--color-primary),
    'border': '1px solid var(--color-primary)',
    'hover': (
      'bg': rgba(var(--color-primary-rgb), 0.05),
      'transform': 'translateY(-1px)'
    ),
    'active': (
      'transform': 'translateY(0)',
      'bg': rgba(var(--color-primary-rgb), 0.1)
    ),
    'dark': (
      'text': var(--color-dark-primary),
      'border': '1px solid var(--color-dark-primary)',
      'hover': (
        'bg': rgba(var(--color-dark-primary-rgb), 0.1)
      )
    ),
    'spinner': (
      'border-color': rgba(var(--color-primary-rgb), 0.3),
      'border-top-color': var(--color-primary)
    )
  ),
  'text': (
    'bg': transparent,
    'text': var(--color-primary),
    'border': none,
    'padding-adjustment': '-0.625rem -1rem', // Negative padding to maintain alignment
    'hover': (
      'bg': rgba(var(--color-primary-rgb), 0.05)
    ),
    'active': (
      'bg': rgba(var(--color-primary-rgb), 0.1)
    ),
    'dark': (
      'text': var(--color-dark-primary),
      'hover': (
        'bg': rgba(var(--color-dark-primary-rgb), 0.1)
      )
    ),
    'spinner': (
      'border-color': rgba(var(--color-primary-rgb), 0.3),
      'border-top-color': var(--color-primary)
    )
  )
);

// ----------------------------------------------------------------------------
// TOKEN ACCESS FUNCTIONS
// ----------------------------------------------------------------------------

/**
 * Get button token value
 * 
 * @param {String} $variant - Button variant (primary, secondary, outline, text)
 * @param {String} $property - Property to access
 * @param {String} $state - Button state (null, hover, focus)
 * @param {Boolean} $dark - Whether to use dark theme values
 * @return {*} Token value
 */
@function button-token($variant, $property, $state: null, $dark: false) {
  @if not map-has-key($button-variant-tokens, $variant) {
    @warn 'Unknown button variant: #{$variant}';
    @return null;
  }
  
  $variant-map: map-get($button-variant-tokens, $variant);
  
  // Handle dark theme with graceful fallback
  @if $dark and map-has-key($variant-map, 'dark') {
    $dark-map: map-get($variant-map, 'dark');
    
    @if $state and map-has-key($dark-map, $state) {
      $state-map: map-get($dark-map, $state);
      
      @if map-has-key($state-map, $property) {
        @return map-get($state-map, $property);
      }
    } @else if map-has-key($dark-map, $property) {
      @return map-get($dark-map, $property);
    }
    
    // If dark theme value not found, continue with regular lookup
  }
  
  @if $state and map-has-key($variant-map, $state) {
    $state-map: map-get($variant-map, $state);
    
    @if map-has-key($state-map, $property) {
      @return map-get($state-map, $property);
    }
  } @else if map-has-key($variant-map, $property) {
    @return map-get($variant-map, $property);
  }
  
  @warn 'Unknown token: #{$variant}.#{$property} for state: #{$state}';
  @return null;
}

/**
 * Get button size token
 * 
 * @param {String} $size - Size variant (sm, md, lg)
 * @param {String} $property - Property to access
 * @return {*} Size value
 */
@function button-size($size, $property) {
  @if map-has-key($button-size-tokens, $size) {
    $size-map: map-get($button-size-tokens, $size);
    
    @if map-has-key($size-map, $property) {
      @return map-get($size-map, $property);
    }
  }
  
  @warn 'Button size token `#{$size}: #{$property}` not found';
  @return null;
}

/**
 * Get base button token
 * 
 * @param {String} $property - Property to access
 * @return {*} Base token value
 */
@function button-base($property) {
  @if map-has-key($button-base-tokens, $property) {
    @return map-get($button-base-tokens, $property);
  }
  
  @warn 'Button base token `#{$property}` not found';
  @return null;
} 